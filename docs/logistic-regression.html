<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 3 Logistic Regression | MKT 4320: Marketing Analytics</title>
  <meta name="description" content="Lecture materials for MKT 4320 in bookdown style." />
  <meta name="generator" content="bookdown 0.24.4 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 3 Logistic Regression | MKT 4320: Marketing Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture materials for MKT 4320 in bookdown style." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 3 Logistic Regression | MKT 4320: Marketing Analytics" />
  
  <meta name="twitter:description" content="Lecture materials for MKT 4320 in bookdown style." />
  

<meta name="author" content="Jeffrey Meyer" />


<meta name="date" content="2022-01-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="targeting-and-retaining-customers.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html"><i class="fa fa-check"></i><b>1</b> Examining and Summarizing Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#r-packages-and-datasets-for-topic-1"><i class="fa fa-check"></i><b>1.2</b> R Packages and Datasets for Topic 1</a></li>
<li class="chapter" data-level="1.3" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#describing-data"><i class="fa fa-check"></i><b>1.3</b> Describing Data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#univariate---graphs-and-tables"><i class="fa fa-check"></i><b>1.3.1</b> Univariate - Graphs and Tables</a>
<ul>
<li class="chapter" data-level="1.3.1.1" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#bar-chart"><i class="fa fa-check"></i><b>1.3.1.1</b> Bar Chart</a></li>
<li class="chapter" data-level="1.3.1.2" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#histogram"><i class="fa fa-check"></i><b>1.3.1.2</b> Histogram</a></li>
<li class="chapter" data-level="1.3.1.3" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#box-plot"><i class="fa fa-check"></i><b>1.3.1.3</b> Box Plot</a></li>
<li class="chapter" data-level="1.3.1.4" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#frequency-table"><i class="fa fa-check"></i><b>1.3.1.4</b> Frequency Table</a></li>
</ul></li>
<li class="chapter" data-level="1.3.2" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#univariate---statistics"><i class="fa fa-check"></i><b>1.3.2</b> Univariate - Statistics</a>
<ul>
<li class="chapter" data-level="1.3.2.1" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#measures-of-centrality"><i class="fa fa-check"></i><b>1.3.2.1</b> Measures of Centrality</a></li>
<li class="chapter" data-level="1.3.2.2" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#measures-of-dispersion"><i class="fa fa-check"></i><b>1.3.2.2</b> Measures of Dispersion</a></li>
</ul></li>
<li class="chapter" data-level="1.3.3" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#bivariate---graphs-and-tables"><i class="fa fa-check"></i><b>1.3.3</b> Bivariate - Graphs and Tables</a>
<ul>
<li class="chapter" data-level="1.3.3.1" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#scatterplots"><i class="fa fa-check"></i><b>1.3.3.1</b> Scatterplots</a></li>
<li class="chapter" data-level="1.3.3.2" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#crosstabs"><i class="fa fa-check"></i><b>1.3.3.2</b> Crosstabs</a></li>
<li class="chapter" data-level="1.3.3.3" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#box-plot-1"><i class="fa fa-check"></i><b>1.3.3.3</b> Box Plot</a></li>
<li class="chapter" data-level="1.3.3.4" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#bar-chart-1"><i class="fa fa-check"></i><b>1.3.3.4</b> Bar Chart</a></li>
</ul></li>
<li class="chapter" data-level="1.3.4" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#statistics"><i class="fa fa-check"></i><b>1.3.4</b> Statistics</a>
<ul>
<li class="chapter" data-level="1.3.4.1" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#correlation"><i class="fa fa-check"></i><b>1.3.4.1</b> Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#suggested-readings"><i class="fa fa-check"></i><b>1.4</b> Suggested Readings</a></li>
<li class="chapter" data-level="1.5" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#r-code"><i class="fa fa-check"></i><b>1.5</b> R Code</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#table11"><i class="fa fa-check"></i><b>1.5.1</b> Table1.1</a></li>
<li class="chapter" data-level="1.5.2" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#table12"><i class="fa fa-check"></i><b>1.5.2</b> Table1.2</a></li>
<li class="chapter" data-level="1.5.3" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#table13"><i class="fa fa-check"></i><b>1.5.3</b> Table1.3</a></li>
<li class="chapter" data-level="1.5.4" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#table14"><i class="fa fa-check"></i><b>1.5.4</b> Table1.4</a></li>
<li class="chapter" data-level="1.5.5" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#table15"><i class="fa fa-check"></i><b>1.5.5</b> Table1.5</a></li>
<li class="chapter" data-level="1.5.6" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure11"><i class="fa fa-check"></i><b>1.5.6</b> Figure 1.1</a></li>
<li class="chapter" data-level="1.5.7" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure12"><i class="fa fa-check"></i><b>1.5.7</b> Figure 1.2</a></li>
<li class="chapter" data-level="1.5.8" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure13"><i class="fa fa-check"></i><b>1.5.8</b> Figure 1.3</a></li>
<li class="chapter" data-level="1.5.9" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure14"><i class="fa fa-check"></i><b>1.5.9</b> Figure 1.4</a></li>
<li class="chapter" data-level="1.5.10" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure15"><i class="fa fa-check"></i><b>1.5.10</b> Figure 1.5</a></li>
<li class="chapter" data-level="1.5.11" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure16"><i class="fa fa-check"></i><b>1.5.11</b> Figure 1.6</a></li>
<li class="chapter" data-level="1.5.12" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure17"><i class="fa fa-check"></i><b>1.5.12</b> Figure 1.7</a></li>
<li class="chapter" data-level="1.5.13" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure18"><i class="fa fa-check"></i><b>1.5.13</b> Figure 1.8</a></li>
<li class="chapter" data-level="1.5.14" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure19"><i class="fa fa-check"></i><b>1.5.14</b> Figure 1.9</a></li>
<li class="chapter" data-level="1.5.15" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure110"><i class="fa fa-check"></i><b>1.5.15</b> Figure 1.10</a></li>
<li class="chapter" data-level="1.5.16" data-path="examining-and-summarizing-data.html"><a href="examining-and-summarizing-data.html#figure111"><i class="fa fa-check"></i><b>1.5.16</b> Figure 1.11</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>2</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="linear-regression.html"><a href="linear-regression.html#motivation-1"><i class="fa fa-check"></i><b>2.1</b> Motivation</a></li>
<li class="chapter" data-level="2.2" data-path="linear-regression.html"><a href="linear-regression.html#r-packages-and-datasets-for-topic-2"><i class="fa fa-check"></i><b>2.2</b> R Packages and Datasets for Topic 2</a></li>
<li class="chapter" data-level="2.3" data-path="linear-regression.html"><a href="linear-regression.html#understanding-regression-analysis"><i class="fa fa-check"></i><b>2.3</b> Understanding Regression Analysis</a></li>
<li class="chapter" data-level="2.4" data-path="linear-regression.html"><a href="linear-regression.html#conducting-linear-regression"><i class="fa fa-check"></i><b>2.4</b> Conducting Linear Regression</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="linear-regression.html"><a href="linear-regression.html#check-data-requirements"><i class="fa fa-check"></i><b>2.4.1</b> Check Data Requirements</a></li>
<li class="chapter" data-level="2.4.2" data-path="linear-regression.html"><a href="linear-regression.html#model-specification"><i class="fa fa-check"></i><b>2.4.2</b> Model Specification</a></li>
<li class="chapter" data-level="2.4.3" data-path="linear-regression.html"><a href="linear-regression.html#model-estimation"><i class="fa fa-check"></i><b>2.4.3</b> Model Estimation</a></li>
<li class="chapter" data-level="2.4.4" data-path="linear-regression.html"><a href="linear-regression.html#model-interpetation"><i class="fa fa-check"></i><b>2.4.4</b> Model Interpetation</a></li>
<li class="chapter" data-level="2.4.5" data-path="linear-regression.html"><a href="linear-regression.html#model-prediction"><i class="fa fa-check"></i><b>2.4.5</b> Model Prediction</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-example"><i class="fa fa-check"></i><b>2.5</b> Linear Regression Example</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="linear-regression.html"><a href="linear-regression.html#overview"><i class="fa fa-check"></i><b>2.5.1</b> Overview</a></li>
<li class="chapter" data-level="2.5.2" data-path="linear-regression.html"><a href="linear-regression.html#summarize-data"><i class="fa fa-check"></i><b>2.5.2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#univariate-summary-statistics"><i class="fa fa-check"></i><b>2.5.2.1</b> Univariate Summary Statistics</a></li>
<li class="chapter" data-level="2.5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#scatterplot-and-correlation-matrix"><i class="fa fa-check"></i><b>2.5.2.2</b> Scatterplot and Correlation Matrix</a></li>
<li class="chapter" data-level="2.5.2.3" data-path="linear-regression.html"><a href="linear-regression.html#box-plots"><i class="fa fa-check"></i><b>2.5.2.3</b> Box Plots</a></li>
</ul></li>
<li class="chapter" data-level="2.5.3" data-path="linear-regression.html"><a href="linear-regression.html#results"><i class="fa fa-check"></i><b>2.5.3</b> Results</a>
<ul>
<li class="chapter" data-level="2.5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#r-output"><i class="fa fa-check"></i><b>2.5.3.1</b> R Output</a></li>
<li class="chapter" data-level="2.5.3.2" data-path="linear-regression.html"><a href="linear-regression.html#assessing-overall-model-fit"><i class="fa fa-check"></i><b>2.5.3.2</b> Assessing Overall Model Fit</a></li>
<li class="chapter" data-level="2.5.3.3" data-path="linear-regression.html"><a href="linear-regression.html#individual-independent-variables"><i class="fa fa-check"></i><b>2.5.3.3</b> Individual Independent Variables</a></li>
<li class="chapter" data-level="2.5.3.4" data-path="linear-regression.html"><a href="linear-regression.html#model-prediction-1"><i class="fa fa-check"></i><b>2.5.3.4</b> Model Prediction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="linear-regression.html"><a href="linear-regression.html#categorical-ivs"><i class="fa fa-check"></i><b>2.6</b> Categorical IVs</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="linear-regression.html"><a href="linear-regression.html#overview-1"><i class="fa fa-check"></i><b>2.6.1</b> Overview</a></li>
<li class="chapter" data-level="2.6.2" data-path="linear-regression.html"><a href="linear-regression.html#intercept-shifter"><i class="fa fa-check"></i><b>2.6.2</b> Intercept Shifter</a></li>
<li class="chapter" data-level="2.6.3" data-path="linear-regression.html"><a href="linear-regression.html#slope-shifter"><i class="fa fa-check"></i><b>2.6.3</b> Slope Shifter</a></li>
<li class="chapter" data-level="2.6.4" data-path="linear-regression.html"><a href="linear-regression.html#intercept-and-slope-shifter"><i class="fa fa-check"></i><b>2.6.4</b> Intercept and Slope Shifter</a></li>
<li class="chapter" data-level="2.6.5" data-path="linear-regression.html"><a href="linear-regression.html#multiple-levels"><i class="fa fa-check"></i><b>2.6.5</b> Multiple Levels</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="linear-regression.html"><a href="linear-regression.html#categorical-ivs-example"><i class="fa fa-check"></i><b>2.7</b> Categorical IVs Example</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="linear-regression.html"><a href="linear-regression.html#overview-2"><i class="fa fa-check"></i><b>2.7.1</b> Overview</a></li>
<li class="chapter" data-level="2.7.2" data-path="linear-regression.html"><a href="linear-regression.html#intercept-shift"><i class="fa fa-check"></i><b>2.7.2</b> Intercept Shift</a></li>
<li class="chapter" data-level="2.7.3" data-path="linear-regression.html"><a href="linear-regression.html#slope-shift"><i class="fa fa-check"></i><b>2.7.3</b> Slope Shift</a></li>
<li class="chapter" data-level="2.7.4" data-path="linear-regression.html"><a href="linear-regression.html#intercept-and-slope-shift"><i class="fa fa-check"></i><b>2.7.4</b> Intercept and Slope Shift</a></li>
<li class="chapter" data-level="2.7.5" data-path="linear-regression.html"><a href="linear-regression.html#intercept-shift-with-multiple-levels"><i class="fa fa-check"></i><b>2.7.5</b> Intercept Shift with Multiple Levels</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="linear-regression.html"><a href="linear-regression.html#suggested-readings-1"><i class="fa fa-check"></i><b>2.8</b> Suggested Readings</a></li>
<li class="chapter" data-level="2.9" data-path="linear-regression.html"><a href="linear-regression.html#r-code-1"><i class="fa fa-check"></i><b>2.9</b> R Code</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="linear-regression.html"><a href="linear-regression.html#table21"><i class="fa fa-check"></i><b>2.9.1</b> Table 2.1</a></li>
<li class="chapter" data-level="2.9.2" data-path="linear-regression.html"><a href="linear-regression.html#table22"><i class="fa fa-check"></i><b>2.9.2</b> Table 2.2</a></li>
<li class="chapter" data-level="2.9.3" data-path="linear-regression.html"><a href="linear-regression.html#table23"><i class="fa fa-check"></i><b>2.9.3</b> Table 2.3</a></li>
<li class="chapter" data-level="2.9.4" data-path="linear-regression.html"><a href="linear-regression.html#table24"><i class="fa fa-check"></i><b>2.9.4</b> Table 2.4</a></li>
<li class="chapter" data-level="2.9.5" data-path="linear-regression.html"><a href="linear-regression.html#table25"><i class="fa fa-check"></i><b>2.9.5</b> Table 2.5</a></li>
<li class="chapter" data-level="2.9.6" data-path="linear-regression.html"><a href="linear-regression.html#table26"><i class="fa fa-check"></i><b>2.9.6</b> Table 2.6</a></li>
<li class="chapter" data-level="2.9.7" data-path="linear-regression.html"><a href="linear-regression.html#table27"><i class="fa fa-check"></i><b>2.9.7</b> Table 2.7</a></li>
<li class="chapter" data-level="2.9.8" data-path="linear-regression.html"><a href="linear-regression.html#table28"><i class="fa fa-check"></i><b>2.9.8</b> Table 2.8</a></li>
<li class="chapter" data-level="2.9.9" data-path="linear-regression.html"><a href="linear-regression.html#table29"><i class="fa fa-check"></i><b>2.9.9</b> Table 2.9</a></li>
<li class="chapter" data-level="2.9.10" data-path="linear-regression.html"><a href="linear-regression.html#figure21"><i class="fa fa-check"></i><b>2.9.10</b> Figure 2.1</a></li>
<li class="chapter" data-level="2.9.11" data-path="linear-regression.html"><a href="linear-regression.html#figure22"><i class="fa fa-check"></i><b>2.9.11</b> Figure 2.2</a></li>
<li class="chapter" data-level="2.9.12" data-path="linear-regression.html"><a href="linear-regression.html#figure23"><i class="fa fa-check"></i><b>2.9.12</b> Figure 2.3</a></li>
<li class="chapter" data-level="2.9.13" data-path="linear-regression.html"><a href="linear-regression.html#figure24"><i class="fa fa-check"></i><b>2.9.13</b> Figure 2.4</a></li>
<li class="chapter" data-level="2.9.14" data-path="linear-regression.html"><a href="linear-regression.html#figure25"><i class="fa fa-check"></i><b>2.9.14</b> Figure 2.5</a></li>
<li class="chapter" data-level="2.9.15" data-path="linear-regression.html"><a href="linear-regression.html#figure26"><i class="fa fa-check"></i><b>2.9.15</b> Figure 2.6</a></li>
<li class="chapter" data-level="2.9.16" data-path="linear-regression.html"><a href="linear-regression.html#figure27"><i class="fa fa-check"></i><b>2.9.16</b> Figure 2.7</a></li>
<li class="chapter" data-level="2.9.17" data-path="linear-regression.html"><a href="linear-regression.html#figure28"><i class="fa fa-check"></i><b>2.9.17</b> Figure 2.8</a></li>
<li class="chapter" data-level="2.9.18" data-path="linear-regression.html"><a href="linear-regression.html#figure29"><i class="fa fa-check"></i><b>2.9.18</b> Figure 2.9</a></li>
<li class="chapter" data-level="2.9.19" data-path="linear-regression.html"><a href="linear-regression.html#figure210"><i class="fa fa-check"></i><b>2.9.19</b> Figure 2.10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#motivation-2"><i class="fa fa-check"></i><b>3.1</b> Motivation</a></li>
<li class="chapter" data-level="3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-packages-and-datasets-for-topic-3"><i class="fa fa-check"></i><b>3.2</b> R Packages and Datasets for Topic 3</a></li>
<li class="chapter" data-level="3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#why-not-use-linear-regression"><i class="fa fa-check"></i><b>3.3</b> Why not use linear regression?</a></li>
<li class="chapter" data-level="3.4" data-path="logistic-regression.html"><a href="logistic-regression.html#understanding-logistic-regression"><i class="fa fa-check"></i><b>3.4</b> Understanding Logistic Regression</a></li>
<li class="chapter" data-level="3.5" data-path="logistic-regression.html"><a href="logistic-regression.html#conducting-logistic-regression"><i class="fa fa-check"></i><b>3.5</b> Conducting Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#model-estimation-1"><i class="fa fa-check"></i><b>3.5.1</b> Model Estimation</a></li>
<li class="chapter" data-level="3.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#assessing-model-fit"><i class="fa fa-check"></i><b>3.5.2</b> Assessing Model Fit</a>
<ul>
<li class="chapter" data-level="3.5.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#goodness-of-fit-measures"><i class="fa fa-check"></i><b>3.5.2.1</b> Goodness-of-Fit Measures</a></li>
<li class="chapter" data-level="3.5.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#classification-matrix"><i class="fa fa-check"></i><b>3.5.2.2</b> Classification Matrix</a></li>
<li class="chapter" data-level="3.5.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-curve"><i class="fa fa-check"></i><b>3.5.2.3</b> ROC Curve</a></li>
</ul></li>
<li class="chapter" data-level="3.5.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interpreting-coefficients"><i class="fa fa-check"></i><b>3.5.3</b> Interpreting Coefficients</a></li>
<li class="chapter" data-level="3.5.4" data-path="logistic-regression.html"><a href="logistic-regression.html#gain-and-lift"><i class="fa fa-check"></i><b>3.5.4</b> Gain and Lift</a>
<ul>
<li class="chapter" data-level="3.5.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#gain"><i class="fa fa-check"></i><b>3.5.4.1</b> Gain</a></li>
<li class="chapter" data-level="3.5.4.2" data-path="logistic-regression.html"><a href="logistic-regression.html#lift"><i class="fa fa-check"></i><b>3.5.4.2</b> Lift</a></li>
</ul></li>
<li class="chapter" data-level="3.5.5" data-path="logistic-regression.html"><a href="logistic-regression.html#sensitivityspecificity-plots"><i class="fa fa-check"></i><b>3.5.5</b> Sensitivity/Specificity Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-example"><i class="fa fa-check"></i><b>3.6</b> Logistic Regression Example</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#overview-3"><i class="fa fa-check"></i><b>3.6.1</b> Overview</a></li>
<li class="chapter" data-level="3.6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-results"><i class="fa fa-check"></i><b>3.6.2</b> Estimation Results</a></li>
<li class="chapter" data-level="3.6.3" data-path="logistic-regression.html"><a href="logistic-regression.html#overall-model-fit"><i class="fa fa-check"></i><b>3.6.3</b> Overall Model Fit</a></li>
<li class="chapter" data-level="3.6.4" data-path="logistic-regression.html"><a href="logistic-regression.html#interpreting-coefficients-1"><i class="fa fa-check"></i><b>3.6.4</b> Interpreting Coefficients</a></li>
<li class="chapter" data-level="3.6.5" data-path="logistic-regression.html"><a href="logistic-regression.html#gain-1"><i class="fa fa-check"></i><b>3.6.5</b> Gain</a></li>
<li class="chapter" data-level="3.6.6" data-path="logistic-regression.html"><a href="logistic-regression.html#lift-1"><i class="fa fa-check"></i><b>3.6.6</b> Lift</a></li>
<li class="chapter" data-level="3.6.7" data-path="logistic-regression.html"><a href="logistic-regression.html#sensitivityspecificity-plots-1"><i class="fa fa-check"></i><b>3.6.7</b> Sensitivity/Specificity Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="logistic-regression.html"><a href="logistic-regression.html#suggested-readings-2"><i class="fa fa-check"></i><b>3.7</b> Suggested Readings</a></li>
<li class="chapter" data-level="3.8" data-path="logistic-regression.html"><a href="logistic-regression.html#r-code-2"><i class="fa fa-check"></i><b>3.8</b> R Code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html"><i class="fa fa-check"></i><b>4</b> Targeting and Retaining Customers</a>
<ul>
<li class="chapter" data-level="4.1" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#r-packages-and-datasets-for-topic-4"><i class="fa fa-check"></i><b>4.1</b> R Packages and Datasets for Topic 4</a></li>
<li class="chapter" data-level="4.2" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#targeting-customers"><i class="fa fa-check"></i><b>4.2</b> Targeting Customers</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#goal"><i class="fa fa-check"></i><b>4.2.1</b> Goal</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#retaining-customers"><i class="fa fa-check"></i><b>4.3</b> Retaining Customers</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#goal-1"><i class="fa fa-check"></i><b>4.3.1</b> Goal</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#targeting-customers-linear-regression-example"><i class="fa fa-check"></i><b>4.4</b> Targeting Customers (Linear Regression) Example</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#overview-4"><i class="fa fa-check"></i><b>4.4.1</b> Overview</a></li>
<li class="chapter" data-level="4.4.2" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#summarize-data-1"><i class="fa fa-check"></i><b>4.4.2</b> Summarize Data</a></li>
<li class="chapter" data-level="4.4.3" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#model-specification-1"><i class="fa fa-check"></i><b>4.4.3</b> Model Specification</a></li>
<li class="chapter" data-level="4.4.4" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#model-interpretation"><i class="fa fa-check"></i><b>4.4.4</b> Model Interpretation</a>
<ul>
<li class="chapter" data-level="4.4.4.1" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#results-1"><i class="fa fa-check"></i><b>4.4.4.1</b> Results</a></li>
<li class="chapter" data-level="4.4.4.2" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#testing-overall-model-significance"><i class="fa fa-check"></i><b>4.4.4.2</b> Testing Overall Model Significance</a></li>
<li class="chapter" data-level="4.4.4.3" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#assessing-overall-model-fit-1"><i class="fa fa-check"></i><b>4.4.4.3</b> Assessing overall model fit</a></li>
<li class="chapter" data-level="4.4.4.4" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#interpret-individual-ivs"><i class="fa fa-check"></i><b>4.4.4.4</b> Interpret Individual IVs</a></li>
</ul></li>
<li class="chapter" data-level="4.4.5" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#conclusion"><i class="fa fa-check"></i><b>4.4.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#targeting-customers-logistic-regression"><i class="fa fa-check"></i><b>4.5</b> Targeting Customers (Logistic Regression)</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#overview-5"><i class="fa fa-check"></i><b>4.5.1</b> Overview</a></li>
<li class="chapter" data-level="4.5.2" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#estimation-results-1"><i class="fa fa-check"></i><b>4.5.2</b> Estimation Results</a></li>
<li class="chapter" data-level="4.5.3" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#overall-model-fit-1"><i class="fa fa-check"></i><b>4.5.3</b> Overall Model Fit</a></li>
<li class="chapter" data-level="4.5.4" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#interpreting-coefficients-2"><i class="fa fa-check"></i><b>4.5.4</b> Interpreting Coefficients</a></li>
<li class="chapter" data-level="4.5.5" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#interpreting-coefficients-visually"><i class="fa fa-check"></i><b>4.5.5</b> Interpreting Coefficients Visually</a></li>
<li class="chapter" data-level="4.5.6" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#gain-chart"><i class="fa fa-check"></i><b>4.5.6</b> Gain Chart</a></li>
<li class="chapter" data-level="4.5.7" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#lift-chart"><i class="fa fa-check"></i><b>4.5.7</b> Lift Chart</a></li>
<li class="chapter" data-level="4.5.8" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#conclusion-1"><i class="fa fa-check"></i><b>4.5.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#suggested-readings-3"><i class="fa fa-check"></i><b>4.6</b> Suggested Readings</a></li>
<li class="chapter" data-level="4.7" data-path="targeting-and-retaining-customers.html"><a href="targeting-and-retaining-customers.html#r-code-3"><i class="fa fa-check"></i><b>4.7</b> R Code</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MKT 4320: Marketing Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1" number="3">
<h1><span class="header-section-number">Topic 3</span> Logistic Regression</h1>
<div id="motivation-2" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Motivation</h2>
<ul>
<li>Marketers often observe binary outcomes
<ul>
<li>Did a customer:
<ul>
<li>purchase?</li>
<li>subscribe?</li>
<li>renew?</li>
<li>respond?</li>
</ul></li>
</ul></li>
<li>Using linear regression is not appropriate…</li>
<li>…But logistic regression still allows us to:
<ul>
<li>Understand IV/DV relationships</li>
<li>Make predictions</li>
</ul></li>
</ul>
</div>
<div id="r-packages-and-datasets-for-topic-3" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> R Packages and Datasets for Topic 3</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="logistic-regression.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)       <span class="co"># Advanced graphing capabilities</span></span>
<span id="cb39-2"><a href="logistic-regression.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)         <span class="co"># Easier programming   </span></span>
<span id="cb39-3"><a href="logistic-regression.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)     <span class="co"># Better HTML Tables</span></span>
<span id="cb39-4"><a href="logistic-regression.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlTable)     <span class="co"># Better HTML Tables</span></span>
<span id="cb39-5"><a href="logistic-regression.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)        <span class="co"># Concise regression results</span></span>
<span id="cb39-6"><a href="logistic-regression.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)         <span class="co"># Easier programming</span></span>
<span id="cb39-7"><a href="logistic-regression.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)         <span class="co"># Create data partitions</span></span>
<span id="cb39-8"><a href="logistic-regression.html#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;Topic03/directmktg.rdata&quot;</span>)</span>
<span id="cb39-9"><a href="logistic-regression.html#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;Topic03/or_table.R&quot;</span>)</span>
<span id="cb39-10"><a href="logistic-regression.html#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;Topic03/logreg_cm.R&quot;</span>)</span>
<span id="cb39-11"><a href="logistic-regression.html#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;Topic03/logreg_roc.R&quot;</span>)</span>
<span id="cb39-12"><a href="logistic-regression.html#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;Topic03/gainlift.R&quot;</span>)</span>
<span id="cb39-13"><a href="logistic-regression.html#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;Topic03/logreg_cut.R&quot;</span>)</span></code></pre></div>
<p><a href="Topic03/directmktg.rdata">Download directmktg.rdata</a></p>
</div>
<div id="why-not-use-linear-regression" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Why not use linear regression?</h2>
<p>Want to see how <span class="math inline">\(age\)</span> affects <span class="math inline">\(buy\)</span></p>
<ul>
<li><span class="math inline">\(buy=\begin{cases}1\text{ if yes/true}\\0\text{ if no/false}\end{cases}\)</span></li>
</ul>
<p>Examine relationship with a scatterplot</p>
<ul>
<li><p>What do we see?</p>
<div class="figure"><span style="display:block;" id="fig:t3scatter01"></span>
<img src="_main_files/figure-html/t3scatter01-1.png" alt="Scatterplot with binary DV ([R code](#figure-reffigt3scatter01))" width="672" />
<p class="caption">
Figure 3.1: Scatterplot with binary DV (<a href="logistic-regression.html#figure-reffigt3scatter01">R code</a>)
</p>
</div></li>
<li><p>Try linear regression: <span class="math inline">\(buy=\alpha+\beta_1 age\)</span><br />
</p>
<caption>
<p><span id="tab:t3linreg01">Table 3.1: </span> Linear Regression Results (<a href="logistic-regression.html#table-reftabt3linreg01">R code</a>)</p>
</caption>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
<p>F(1,398)</p>
</td>
<td style="text-align:right;">
<p>251.7421</p>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
<p>R²</p>
</td>
<td style="text-align:right;">
<p>0.3874</p>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
<p>Adj. R²</p>
</td>
<td style="text-align:right;">
<p>0.3859</p>
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<p>Est.</p>
</th>
<th style="text-align:right;">
<p>S.E.</p>
</th>
<th style="text-align:right;">
<p>t val.</p>
</th>
<th style="text-align:right;">
<p>p</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
<p>(Intercept)</p>
</td>
<td style="text-align:right;">
<p>-0.7154</p>
</td>
<td style="text-align:right;">
<p>0.0702</p>
</td>
<td style="text-align:right;">
<p>-10.1930</p>
</td>
<td style="text-align:right;">
<p>0.0000</p>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
<p>age</p>
</td>
<td style="text-align:right;">
<p>0.0285</p>
</td>
<td style="text-align:right;">
<p>0.0018</p>
</td>
<td style="text-align:right;">
<p>15.8664</p>
</td>
<td style="text-align:right;">
<p>0.0000</p>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<p><sup></sup> Standard errors: OLS</p>
</td>
</tr>
</tfoot>
</table></li>
<li><p>Good <span class="math inline">\(R^2\)</span> and <span class="math inline">\(age\)</span> is highly significant</p></li>
<li><p>So what’s the problem?</p></li>
<li><p>Predict <span class="math inline">\(buy\)</span> from linear regression results:<br>
<span class="math inline">\(\hat{buy}=-.7154+.0285age\)</span></p></li>
<li><p>Prediction line shown in plot</p>
<div class="figure"><span style="display:block;" id="fig:t3scatter02"></span>
<img src="_main_files/figure-html/t3scatter02-1.png" alt="Predicted Values from Linear Regression ([R code](#figure-reffigt3scatter02))" width="672" />
<p class="caption">
Figure 3.2: Predicted Values from Linear Regression (<a href="logistic-regression.html#figure-reffigt3scatter02">R code</a>)
</p>
</div></li>
<li><p>Add <span class="math inline">\(age\)</span> categories and plot mean <span class="math inline">\(buy\)</span> for each category</p>
<ul>
<li>What “shape” does this resemble?</li>
<li>Can we use this “shape” to model the relationship?</li>
</ul>
<div class="figure"><span style="display:block;" id="fig:t3lineshape"></span>
<img src="_main_files/figure-html/t3lineshape-1.png" alt="Buy for Age Groups ([R code](#figure-reffigt3lineshape))" width="672" />
<p class="caption">
Figure 3.3: Buy for Age Groups (<a href="logistic-regression.html#figure-reffigt3lineshape">R code</a>)
</p>
</div></li>
</ul>
</div>
<div id="understanding-logistic-regression" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Understanding Logistic Regression</h2>
<ul>
<li>Uses the logistic function:<br>
<span class="math inline">\(f(z)=\frac{e^u}{1+e^u}\)</span>
<ul>
<li><span class="math inline">\(f(z)\)</span> is the probability of event happening</li>
<li><span class="math inline">\(u\)</span> is a linear function, such as: <span class="math inline">\(\alpha+\beta x\)</span></li>
</ul></li>
<li>Ensures predictions are never above 1 or below 0
<div class="figure"><span style="display:block;" id="fig:t3logitcurve"></span>
<img src="_main_files/figure-html/t3logitcurve-1.png" alt="Logistic Function ([R code](#figure-reffigt3logitcurve))" width="672" />
<p class="caption">
Figure 3.4: Logistic Function (<a href="logistic-regression.html#figure-reffigt3logitcurve">R code</a>)
</p>
</div></li>
<li>Probability of event success vs. failure <span class="math inline">\(=\frac{f(z)}{1-f(z)}=\)</span> Odds Ratio (<span class="math inline">\(OR\)</span>)
<ul>
<li>Suppose probability of success <span class="math inline">\(=.01\)</span>, then:<br>
<span class="math inline">\(OR=\frac{.01}{1-.01}=.0101\)</span>
<ul>
<li>Suppose probability of success <span class="math inline">\(=.001\)</span>, then:<br>
<span class="math inline">\(OR=\frac{.001}{1-.001}=.0010\)</span></li>
<li>Suppose probability of success <span class="math inline">\(=.99\)</span>, then:<br>
<span class="math inline">\(OR=\frac{.99}{1-.99}=99\)</span></li>
<li>Suppose probability of success <span class="math inline">\(=.999\)</span>, then:<br>
<span class="math inline">\(OR=\frac{.999}{1-.999}=999\)</span></li>
<li>Suppose probability of success <span class="math inline">\(=.5\)</span>, then:<br>
<span class="math inline">\(OR=\frac{.5}{1-.5}=1\)</span></li>
</ul></li>
</ul></li>
<li>Substituting logistic function for <span class="math inline">\(f(z)\)</span> into Odds Ratio <span class="math inline">\(\Rightarrow\)</span><br>
<span class="math inline">\(OR=e^u=e^{\alpha+betax}\)</span>
<ul>
<li><span class="math inline">\(\frac{f(z)}{1-f(z)}=\frac{\frac{e^u}{1+e^u}}{1-\frac{e^u}{1+e^u}}=\frac{\frac{e^u}{1+e^u}}{\frac{1+e^u}{1+e^u}-\frac{e^u}{1+e^u}}=\frac{\frac{e^u}{1+e^u}}{\frac{1}{1+e^u}}=e^u\)</span></li>
</ul></li>
<li>Can transform exponential function into linear <span class="math inline">\(\Rightarrow\)</span><br>
<span class="math inline">\(Logit=\ln(OR)=\alpha+\beta x\)</span></li>
</ul>
</div>
<div id="conducting-logistic-regression" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Conducting Logistic Regression</h2>
<ul>
<li>Model Estimation</li>
<li>Assessing Model Fit
<ul>
<li>Goodness of Fit Measures</li>
<li>Classification Matrix</li>
<li>ROC Curve</li>
</ul></li>
<li>Interpreting Coefficients</li>
<li>Gains and Lift</li>
</ul>
<div id="model-estimation-1" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Model Estimation</h3>
<ul>
<li>Best to use training data and holdout data
<ul>
<li>Estimate model on training data (~75% of sample)</li>
<li>Check prediction accuracy on holdout data (~25%)</li>
</ul></li>
<li>Can estimate either (1) <span class="math inline">\(OR\)</span> or (2) <span class="math inline">\(Logit\)</span> formulation
<ol style="list-style-type: decimal">
<li><span class="math inline">\(OR=e^{\alpha+\beta_1x_1+\cdots+\beta_kx_k}\)</span></li>
<li><span class="math inline">\(Logit=\alpha+\beta_1x_1+\cdots+\beta_kx_k\)</span></li>
</ol></li>
<li>Independent variables:
<ul>
<li>Can be one or more</li>
<li>Can be continuous or categorical/factor</li>
</ul></li>
</ul>
</div>
<div id="assessing-model-fit" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Assessing Model Fit</h3>
<div id="goodness-of-fit-measures" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Goodness-of-Fit Measures</h4>
<ul>
<li>Overall significance based on <span class="math inline">\(-2LL\)</span>
<ul>
<li>Lower (closer to <span class="math inline">\(0\)</span>) <span class="math inline">\(-2LL\)</span> indicates a better fit</li>
<li>Compare <span class="math inline">\(-2LL\)</span> of estimated model with “null” model</li>
</ul></li>
<li>McFadden’s Pseudo-<span class="math inline">\(R^2\)</span>
<ul>
<li>Values range from 0 to 1 like linear regression</li>
<li>Interpreted in a similar manner
<ul>
<li>Amount of variation in DV explained by IVs</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="classification-matrix" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Classification Matrix</h4>
<ul>
<li>How does the model do in predicting outcomes?</li>
<li>Generate predicted probability of success, <span class="math inline">\(p(\text{SUCCESS})\)</span>, for each observation
<ul>
<li>If <span class="math inline">\(p(\text{SUCCESS})\ge0.5\)</span>, predict <span class="math inline">\(\text{SUCCESS}=1\)</span></li>
<li>If <span class="math inline">\(p(\text{SUCCESS})&lt;0.5\)</span>, predict <span class="math inline">\(\text{SUCCESS}=0\)</span>, or <span class="math inline">\(\text{FAILURE}\)</span></li>
</ul></li>
<li>Check predictions against actual outcomes
<ul>
<li>Examine both training and holdout data</li>
</ul></li>
</ul>
<div class="figure"><span style="display:block;" id="fig:t3classmatimg"></span>
<img src="Topic03/ClassMat.png" alt="Classification Matrix" width="875" />
<p class="caption">
Figure 3.5: Classification Matrix
</p>
</div>
<ul>
<li>Three main measures
<ul>
<li>Sensitivity: Predicted success given actual success
<ul>
<li><span class="math inline">\(p(\hat{+}|+)=a/(a+c)\)</span></li>
</ul></li>
<li>Specificity: Predicted failure given actual failure
<ul>
<li><span class="math inline">\(p(\hat{-}|-)=d/(b+d)\)</span></li>
</ul></li>
<li>Overall correctly classified
<ul>
<li><span class="math inline">\((a+d)/(a+b+c+d)\)</span></li>
</ul></li>
</ul></li>
<li>Sensitivity vs. Specificity
<ul>
<li>Ideally, want both to be high, but…<br>
the <span class="math inline">\(p(\text{SUCCESS})\ge\pi\)</span> threshold can be changed</li>
<li>Why change <span class="math inline">\(\pi\)</span>? Avoid false positives or negatives</li>
<li>By default:
<ul>
<li>Increasing sensitivity decreases specificity</li>
<li>Increasing specificity decreases sensitivity</li>
</ul></li>
</ul></li>
<li>Overall correctly classified
<ul>
<li>Compare with <em>Proportional Chance Criterion (</em><span class="math inline">\(PCC\)</span><em>)</em>
<ul>
<li><span class="math inline">\(PCC\)</span> is the “average” probability of classification based on group sizes</li>
</ul></li>
<li><span class="math inline">\(PCC=p^2+(1-p)^2\)</span> where <span class="math inline">\(p\)</span> is the proportion of sample in the <span class="math inline">\(\text{SUCCESS}\)</span> group</li>
<li>Overall correctly classified <span class="math inline">\(&gt;PCC\)</span> considered good fit when examining holdout data</li>
</ul></li>
</ul>
</div>
<div id="roc-curve" class="section level4" number="3.5.2.3">
<h4><span class="header-section-number">3.5.2.3</span> ROC Curve</h4>
<ul>
<li>Plot sensitivity by <span class="math inline">\(1-\)</span> specificity as <span class="math inline">\(\pi\)</span> goes from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span></li>
<li>More area under curve means better model
<table style="text-align: center;">
<tr>
<td>
<strong>Area under Curve</strong>
</td>
<td>
<strong>Discrimination</strong>
</td>
</tr>
<tr>
<td style="font-family: cambria;">
<em>AUC</em> = .5
</td>
<td>
None
</td>
</tr>
<tr>
<td style="font-family: cambria;">
.5 &lt; <em>AUC</em> &lt; .7
</td>
<td>
Poor
</td>
</tr>
<tr>
<td style="font-family: cambria;">
.7 ≤ <em>AUC</em> &lt; .8
</td>
<td>
Acceptable
</td>
</tr>
<tr>
<td style="font-family: cambria;">
.8 ≤ <em>AUC</em> &lt; .9
</td>
<td>
Excellent
</td>
</tr>
<tr>
<td style="font-family: cambria;">
<em>AUC</em> ≥ .9
</td>
<td>
Outstanding
</td>
</tr>
</table>
<div class="figure"><span style="display:block;" id="fig:t3sampleroc"></span>
<img src="_main_files/figure-html/t3sampleroc-1.png" alt="Sample ROC Curve" width="672" />
<p class="caption">
Figure 3.6: Sample ROC Curve
</p>
</div></li>
</ul>
</div>
</div>
<div id="interpreting-coefficients" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Interpreting Coefficients</h3>
<ul>
<li>Relationship between DV and each IV</li>
<li><span class="math inline">\(H_0: \beta_k=0\)</span> <em>vs.</em> <span class="math inline">\(H_a: \beta_k\ne0\)</span></li>
<li>Interpret significant relationships
<ul>
<li>Interpretation depends on <span class="math inline">\(OR\)</span> or <span class="math inline">\(Logit\)</span> estimation</li>
<li>Direction of relationship:
<ul>
<li><span class="math inline">\(Logit\)</span> estimation: <span class="math inline">\(\beta_k&gt;0\)</span> for positive, <span class="math inline">\(\beta_k&lt;0\)</span> for negative</li>
<li><span class="math inline">\(OR\)</span> estimation: <span class="math inline">\(\beta_k&gt;1\)</span> for positive, <span class="math inline">\(\beta_k&lt;1\)</span> for negative</li>
</ul></li>
<li>Magnitude of change:
<ul>
<li><span class="math inline">\(Logit\)</span> estimation: coefficients are not particularly useful</li>
<li><span class="math inline">\(OR\)</span> estimation:
<ul>
<li>Percentage change in odds</li>
<li>Compare probabilities between groups</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="gain-and-lift" class="section level3" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Gain and Lift</h3>
<ul>
<li>Evaluate performance of classification</li>
<li>Example:
<ul>
<li>Suppose <span class="math inline">\(10\%\)</span> of <span class="math inline">\(2000\)</span> customers will accept offer</li>
<li>For <span class="math inline">\(100\)</span> random customers, expect <span class="math inline">\(10\)</span> accepted offers</li>
<li>Model predicts some customers more likely to accept</li>
<li>Instead of contacting <span class="math inline">\(100\)</span> random customers…<br>Contact <span class="math inline">\(100\)</span> most likely to accept based on model</li>
<li>Continue doing this in groups of <span class="math inline">\(100\)</span> (or <span class="math inline">\(200\)</span>, etc.)</li>
</ul></li>
<li>Gain and lift provide measures of how much better the model performs vs. no model/random</li>
<li>Process
<ol style="list-style-type: decimal">
<li>Predict $p() for each observation and sort descending</li>
<li>Split into 10 (deciles) or 20 (demi-deciles) ordered groups</li>
<li>Calculate <span class="math inline">\(\%\)</span> observations and <span class="math inline">\(\%\)</span> successes for each group</li>
</ol></li>
</ul>
<div id="gain" class="section level4" number="3.5.4.1">
<h4><span class="header-section-number">3.5.4.1</span> Gain</h4>
<ul>
<li>Cumulative successes up to that group divided by total successes across all groups</li>
<li>Plot on <span class="math inline">\(y\)</span>-axis, with cumulative percent of observations on <span class="math inline">\(x\)</span>-axis
<div class="figure"><span style="display:block;" id="fig:t3typgain"></span>
<img src="_main_files/figure-html/t3typgain-1.png" alt="Typical Gain Chart Shape" width="672" />
<p class="caption">
Figure 3.7: Typical Gain Chart Shape
</p>
</div></li>
</ul>
</div>
<div id="lift" class="section level4" number="3.5.4.2">
<h4><span class="header-section-number">3.5.4.2</span> Lift</h4>
<ul>
<li>Ratio of cumulative success up to that group divided by expected success from no model</li>
<li>Plot on <span class="math inline">\(y\)</span>-axis, with cumulative percent of observations on <span class="math inline">\(x\)</span>-axis
<div class="figure"><span style="display:block;" id="fig:t3typlift"></span>
<img src="_main_files/figure-html/t3typlift-1.png" alt="Typical Lift Chart Shape" width="672" />
<p class="caption">
Figure 3.8: Typical Lift Chart Shape
</p>
</div></li>
</ul>
</div>
</div>
<div id="sensitivityspecificity-plots" class="section level3" number="3.5.5">
<h3><span class="header-section-number">3.5.5</span> Sensitivity/Specificity Plots</h3>
<ul>
<li>Sensitivity, Specificity, and Accuracy depend on the cutoff value for predicting SUCCESS/ FAILURE
<ul>
<li>While 0.5 is the most common threshold, it might not be the best threshold for prediction</li>
</ul></li>
<li>Sensitivity/Specificity Plots can show the analyst how each changes with different cutoff values
<ul>
<li>The analyst can try to balance the three depending on the purpose of project
<div class="figure"><span style="display:block;" id="fig:t3sensspecplot"></span>
<img src="_main_files/figure-html/t3sensspecplot-1.png" alt="Sample Sensitivy/Specificity Plot" width="672" />
<p class="caption">
Figure 3.9: Sample Sensitivy/Specificity Plot
</p>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="logistic-regression-example" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Logistic Regression Example</h2>
<div id="overview-3" class="section level3" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Overview</h3>
<ul>
<li>Purchase data for direct marketing campaign
<ul>
<li>400 observations of individual responses</li>
<li>DV: Purchase made, <span class="math inline">\(buy\)</span> (factor: Yes, No)</li>
<li>IVs:
<ul>
<li>Age, <span class="math inline">\(age\)</span></li>
<li>Estimated Salary ($000s), <span class="math inline">\(salary\)</span></li>
<li>Gender, <span class="math inline">\(gender\)</span> (factor: Male, Female)</li>
</ul></li>
</ul></li>
<li>Predict likelihood of purchase</li>
</ul>
</div>
<div id="estimation-results" class="section level3" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Estimation Results</h3>
<ul>
<li>Logit formulation results<br />

<caption>
<span id="tab:t3logit01">Table 3.2: </span> Logistic Regression Results (Logit Formulation) (<a href="logistic-regression.html#table-reftabt3logit01">R code</a>)
</caption>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
χ²(3)
</td>
<td style="text-align:right;">
182.2574
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Pseudo-R² (Cragg-Uhler)
</td>
<td style="text-align:right;">
0.6231
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Pseudo-R² (McFadden)
</td>
<td style="text-align:right;">
0.4638
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
AIC
</td>
<td style="text-align:right;">
218.6842
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
BIC
</td>
<td style="text-align:right;">
233.5126
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
z val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
-13.1661
</td>
<td style="text-align:right;">
1.6217
</td>
<td style="text-align:right;">
-8.1187
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
age
</td>
<td style="text-align:right;">
0.2502
</td>
<td style="text-align:right;">
0.0321
</td>
<td style="text-align:right;">
7.7961
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
salary
</td>
<td style="text-align:right;">
0.0406
</td>
<td style="text-align:right;">
0.0067
</td>
<td style="text-align:right;">
6.0265
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
genderFemale
</td>
<td style="text-align:right;">
-0.4069
</td>
<td style="text-align:right;">
0.3498
</td>
<td style="text-align:right;">
-1.1631
</td>
<td style="text-align:right;">
0.2448
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: MLE
</td>
</tr>
</tfoot>
</table>
<pre><code>Model p-value = 0.0000</code></pre></li>
<li>Odds Ratio Coefficients<br />

<caption>
<span id="tab:t3logit01or">Table 3.3: </span> Logistic Regression Odds Ratio Coefficients (<a href="logistic-regression.html#table-reftabt3logit01or">R code</a>)
</caption>
<template id="4a9c959d-1b2f-49ff-9370-0281d81c2e0a"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-7b7de222{}.cl-7b76463e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7b766d30{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7b766d31{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7b76bb1e{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b76bb1f{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b76bb20{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b76bb21{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b76bb22{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b76bb23{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-7b7de222'>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-7b76bb23"><p class="cl-7b766d30"><span class="cl-7b76463e">Parameter</span></p></td><td class="cl-7b76bb22"><p class="cl-7b766d31"><span class="cl-7b76463e">OR Est</span></p></td><td class="cl-7b76bb22"><p class="cl-7b766d31"><span class="cl-7b76463e">p</span></p></td><td class="cl-7b76bb22"><p class="cl-7b766d31"><span class="cl-7b76463e">2.5%</span></p></td><td class="cl-7b76bb22"><p class="cl-7b766d31"><span class="cl-7b76463e">97.5%</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7b76bb1f"><p class="cl-7b766d30"><span class="cl-7b76463e">(Intercept)</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">0.0000</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">0.0000</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">0.0000</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">0.0000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7b76bb1f"><p class="cl-7b766d30"><span class="cl-7b76463e">age</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">1.2843</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">0.0000</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">1.2060</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">1.3677</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7b76bb1f"><p class="cl-7b766d30"><span class="cl-7b76463e">salary</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">1.0415</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">0.0000</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">1.0278</span></p></td><td class="cl-7b76bb1e"><p class="cl-7b766d31"><span class="cl-7b76463e">1.0553</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7b76bb21"><p class="cl-7b766d30"><span class="cl-7b76463e">genderFemale</span></p></td><td class="cl-7b76bb20"><p class="cl-7b766d31"><span class="cl-7b76463e">0.6657</span></p></td><td class="cl-7b76bb20"><p class="cl-7b766d31"><span class="cl-7b76463e">0.2448</span></p></td><td class="cl-7b76bb20"><p class="cl-7b766d31"><span class="cl-7b76463e">0.3354</span></p></td><td class="cl-7b76bb20"><p class="cl-7b766d31"><span class="cl-7b76463e">1.3215</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="0f1fb343-2173-4ae7-a96e-5dfb8079d6f3"></div>
<script>
var dest = document.getElementById("0f1fb343-2173-4ae7-a96e-5dfb8079d6f3");
var template = document.getElementById("4a9c959d-1b2f-49ff-9370-0281d81c2e0a");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>
</li>
</ul>
</div>
<div id="overall-model-fit" class="section level3" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Overall Model Fit</h3>
<ul>
<li>Based on the likelihood ratio <span class="math inline">\(\chi^2\)</span> test with a <span class="math inline">\(p\text{-value}&lt;.0001\)</span>, the overall model is significant (see Table <a href="logistic-regression.html#tab:t3logit01">3.2</a>)</li>
<li>McFadden’s Pseudo-<span class="math inline">\(R^2\)</span> of <span class="math inline">\(.464\)</span> means that the model explains about <span class="math inline">\(46\%\)</span> of the variation between buyers/non-buyers (see Table <a href="logistic-regression.html#tab:t3logit01">3.2</a>)</li>
<li>Classification Matrix for the Training Sample shows:
<ul>
<li>High sensitivity (<span class="math inline">\(72.2\%\)</span>)</li>
<li>High specificity (<span class="math inline">\(91.2\%\)</span>)</li>
<li>Correctly classified (<span class="math inline">\(84.4\%\)</span>) &gt; PCC (<span class="math inline">\(54.0\%\)</span>)</li>
</ul>
<caption>
<span id="tab:t3cmtrain">Table 3.4: </span> Classification Matrix for Training Sample (<a href="logistic-regression.html#table-reftabt3cmtrain">R code</a>)
</caption>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  No Yes
       No  176  30
       Yes  17  78

               Accuracy : 0.8439         
                 95% CI : (0.7978, 0.883)
    No Information Rate : 0.6412         
    P-Value [Acc &gt; NIR] : 4.55e-15       

                  Kappa : 0.6514         

 Mcnemar&#39;s Test P-Value : 0.08005        

            Sensitivity : 0.7222         
            Specificity : 0.9119         
         Pos Pred Value : 0.8211         
         Neg Pred Value : 0.8544         
             Prevalence : 0.3588         
         Detection Rate : 0.2591         
   Detection Prevalence : 0.3156         
      Balanced Accuracy : 0.8171         

       &#39;Positive&#39; Class : Yes            

PCC = 53.99%</code></pre></li>
<li>Classification Matrix for the Test/Holdout Sample shows:
<ul>
<li>High sensitivity (<span class="math inline">\(77.1\%\)</span>)</li>
<li>High specificity (<span class="math inline">\(90.6\%\)</span>)</li>
<li>Correctly classified (<span class="math inline">\(85.9\%\)</span>) &gt; PCC (<span class="math inline">\(54.3\%\)</span>)</li>
</ul>
<caption>
<span id="tab:t3cmtest">Table 3.5: </span> Classification Matrix for Test/Holdout Data (<a href="logistic-regression.html#table-reftabt3cmtest">R code</a>)
</caption>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction No Yes
       No  58   8
       Yes  6  27

               Accuracy : 0.8586          
                 95% CI : (0.7741, 0.9205)
    No Information Rate : 0.6465          
    P-Value [Acc &gt; NIR] : 2.004e-06       

                  Kappa : 0.6866          

 Mcnemar&#39;s Test P-Value : 0.7893          

            Sensitivity : 0.7714          
            Specificity : 0.9062          
         Pos Pred Value : 0.8182          
         Neg Pred Value : 0.8788          
             Prevalence : 0.3535          
         Detection Rate : 0.2727          
   Detection Prevalence : 0.3333          
      Balanced Accuracy : 0.8388          

       &#39;Positive&#39; Class : Yes             

PCC = 54.29%</code></pre></li>
<li>ROC Curve for Training Sample
<ul>
<li>Area <span class="math inline">\(&gt;.90\)</span> suggests an outstanding model fit</li>
</ul>
<div class="figure"><span style="display:block;" id="fig:t3roctrain"></span>
<img src="_main_files/figure-html/t3roctrain-1.png" alt="ROC Curve for Training Sample ([R code](#figure-reffigt3roctrain))" width="672" />
<p class="caption">
Figure 3.10: ROC Curve for Training Sample (<a href="logistic-regression.html#figure-reffigt3roctrain">R code</a>)
</p>
</div></li>
<li>ROC Curve for Holdout Sample
<ul>
<li>Area <span class="math inline">\(&gt;.90\)</span> suggests an outstanding model fit</li>
</ul>
<div class="figure"><span style="display:block;" id="fig:t3roctest"></span>
<img src="_main_files/figure-html/t3roctest-1.png" alt="ROC Curve for Test/Holdout Sample ([R code](#figure-reffigt3roctest))" width="672" />
<p class="caption">
Figure 3.11: ROC Curve for Test/Holdout Sample (<a href="logistic-regression.html#figure-reffigt3roctest">R code</a>)
</p>
</div></li>
</ul>
</div>
<div id="interpreting-coefficients-1" class="section level3" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> Interpreting Coefficients</h3>
<ul>
<li><span class="math inline">\(age\)</span> is positive (<span class="math inline">\(OR&gt;1\)</span>) and significant (<span class="math inline">\(p&lt;.001\)</span>)
<ul>
<li><span class="math inline">\(1\)</span> year increase in <span class="math inline">\(age\)</span> increases odds of buying by a factor of <span class="math inline">\(1.28\)</span> (or odds of buying increase by <span class="math inline">\(25\%\)</span>)</li>
</ul></li>
<li><span class="math inline">\(salary\)</span> is positive (<span class="math inline">\(OR&gt;1\)</span>) and significant (<span class="math inline">\(p&lt;.001\)</span>)
<ul>
<li><span class="math inline">\(\$1000\)</span> increase in <span class="math inline">\(salary\)</span> increases odds of buying by a factor of <span class="math inline">\(1.04\)</span> (or odds of buying increase by <span class="math inline">\(4\%\)</span>)</li>
</ul></li>
<li><span class="math inline">\(gender\)</span> is negative (<span class="math inline">\(OR&lt;1\)</span>), but not significant (<span class="math inline">\(p=.245\)</span>)
<ul>
<li>Had it been significant…
Being female decreases odds of buying by a factor of <span class="math inline">\(.67\)</span> (or odds of buying decrease by <span class="math inline">\(33\%\)</span>)</li>
</ul></li>
<li>Can visually examine how <span class="math inline">\(\Pr(buy)\)</span> changes with a variable for continuous IVs
<ul>
<li>Factor variables can be separate lines (see Figure <a href="logistic-regression.html#fig:t3mpage01">3.12</a> or separate plots see <a href="logistic-regression.html#fig:t3mpage02">3.13</a>)
<div class="figure"><span style="display:block;" id="fig:t3mpage01"></span>
<img src="_main_files/figure-html/t3mpage01-1.png" alt="Margin Plot for Age (Separate Lines for Gender) ([R code](#figure-reffigt3mpage01))" width="672" />
<p class="caption">
Figure 3.12: Margin Plot for Age (Separate Lines for Gender) (<a href="logistic-regression.html#figure-reffigt3mpage01">R code</a>)
</p>
</div></li>
</ul>
<div class="figure"><span style="display:block;" id="fig:t3mpage02"></span>
<img src="_main_files/figure-html/t3mpage02-1.png" alt="Margin Plot for Age (Separate Plots for Gender) ([R code](#figure-reffigt3mpage02))" width="672" />
<p class="caption">
Figure 3.13: Margin Plot for Age (Separate Plots for Gender) (<a href="logistic-regression.html#figure-reffigt3mpage02">R code</a>)
</p>
</div>
<ul>
<li>Can create different lines for specific levels of another continuous IV
<ul>
<li>See <a href="logistic-regression.html#fig:t3mpage03">3.14</a> for <span class="math inline">\(age\)</span> with different levels of <span class="math inline">\(salary\)</span></li>
<li>See <a href="logistic-regression.html#fig:t3mpage04">3.15</a> for <span class="math inline">\(salary\)</span> with different levels of <span class="math inline">\(age\)</span></li>
</ul></li>
</ul>
<div class="figure"><span style="display:block;" id="fig:t3mpage03"></span>
<img src="_main_files/figure-html/t3mpage03-1.png" alt="Margin Plot for Age at Different Levels of Salary ([R code](#figure-reffigt3mpage03))" width="672" />
<p class="caption">
Figure 3.14: Margin Plot for Age at Different Levels of Salary (<a href="logistic-regression.html#figure-reffigt3mpage03">R code</a>)
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:t3mpage04"></span>
<img src="_main_files/figure-html/t3mpage04-1.png" alt="Margin Plot for Salary at Different Levels of Age ([R code](#figure-reffigt3mpage04))" width="672" />
<p class="caption">
Figure 3.15: Margin Plot for Salary at Different Levels of Age (<a href="logistic-regression.html#figure-reffigt3mpage04">R code</a>)
</p>
</div></li>
</ul>
</div>
<div id="gain-1" class="section level3" number="3.6.5">
<h3><span class="header-section-number">3.6.5</span> Gain</h3>
<ul>
<li><p>Can examine gain for both the training and holdout samples…</p></li>
<li><p>But using holdout is more informative</p></li>
<li><p>Contacting the top <span class="math inline">\(25\%\)</span> of predicted buyers yields nearly <span class="math inline">\(60\%\)</span> of actual buyers</p>
<caption>
<p><span id="tab:t3gaintable">Table 3.6: </span> Gain Table for Training and Test/Holdout Samples (<a href="logistic-regression.html#table-reftabt3gaintable">R code</a>)</p>
</caption>
<pre><code># A tibble: 20 x 3
   `% Sample` Holdout Training
        &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1       0.05   0.114    0.130
 2       0.1    0.2      0.25 
 3       0.15   0.343    0.370
 4       0.2    0.486    0.481
 5       0.25   0.6      0.593
 6       0.3    0.743    0.713
 7       0.35   0.771    0.778
 8       0.4    0.829    0.843
 9       0.45   0.914    0.907
10       0.5    0.971    0.935
11       0.55   1        0.981
12       0.6    1        0.991
13       0.65   1        0.991
14       0.7    1        0.991
15       0.75   1        1    
16       0.8    1        1    
17       0.85   1        1    
18       0.9    1        1    
19       0.95   1        1    
20       1      1        1    </code></pre>
<div class="figure"><span style="display:block;" id="fig:t3gainplot"></span>
<img src="_main_files/figure-html/t3gainplot-1.png" alt="Gain Chart for Training and Test/Holdout Samples ([R code](#figure-reffigt3gainplot))" width="672" />
<p class="caption">
Figure 3.16: Gain Chart for Training and Test/Holdout Samples (<a href="logistic-regression.html#figure-reffigt3gainplot">R code</a>)
</p>
</div></li>
</ul>
</div>
<div id="lift-1" class="section level3" number="3.6.6">
<h3><span class="header-section-number">3.6.6</span> Lift</h3>
<ul>
<li><p>Can examine gain for both the training and holdout samples…</p></li>
<li><p>But using holdout is more informative</p></li>
<li><p>Contacting the top <span class="math inline">\(25\%\)</span> of predicted buyers provides lift of nearly 2.5</p>
<caption>
<p><span id="tab:t3lifttable">Table 3.7: </span> Lift Table for Training and Test/Holdout Samples (<a href="logistic-regression.html#table-reftabt3lifttable">R code</a>)</p>
</caption>
<pre><code># A tibble: 20 x 3
   `% Sample` Holdout Training
        &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1       0.05    2.83     2.60
 2       0.1     2.2      2.51
 3       0.15    2.42     2.48
 4       0.2     2.53     2.42
 5       0.25    2.48     2.38
 6       0.3     2.54     2.38
 7       0.35    2.25     2.23
 8       0.4     2.10     2.11
 9       0.45    2.06     2.02
10       0.5     1.96     1.88
11       0.55    1.83     1.79
12       0.6     1.68     1.66
13       0.65    1.55     1.53
14       0.7     1.43     1.42
15       0.75    1.34     1.34
16       0.8     1.25     1.25
17       0.85    1.18     1.18
18       0.9     1.11     1.11
19       0.95    1.05     1.06
20       1       1        1   </code></pre>
<div class="figure"><span style="display:block;" id="fig:t3liftplot"></span>
<img src="_main_files/figure-html/t3liftplot-1.png" alt="Lift Chart for Training and Test/Holdout Samples ([R code](#figure-reffigt3liftplot))" width="672" />
<p class="caption">
Figure 3.17: Lift Chart for Training and Test/Holdout Samples (<a href="logistic-regression.html#figure-reffigt3liftplot">R code</a>)
</p>
</div></li>
</ul>
</div>
<div id="sensitivityspecificity-plots-1" class="section level3" number="3.6.7">
<h3><span class="header-section-number">3.6.7</span> Sensitivity/Specificity Plots</h3>
<ul>
<li>Examine to see if different thresholds are warranted
<ul>
<li>Looking at the plots for both the training sample (see Figure <a href="logistic-regression.html#fig:t3sensspec01">3.18</a>) and the test/holdout sample (see Figure <a href="logistic-regression.html#fig:t3sensspec02">3.19</a>), it might be worthwhile to try a cutoff threshold between 0.35 and 0.40
<ul>
<li>Doing so will balance specificity and sensitivity without hurting accuracy
<div class="figure"><span style="display:block;" id="fig:t3sensspec01"></span>
<img src="_main_files/figure-html/t3sensspec01-1.png" alt="Sensitivity/Specificity Plot for Training Sample ([R code](#figure-reffigt3sensspec01))" width="672" />
<p class="caption">
Figure 3.18: Sensitivity/Specificity Plot for Training Sample (<a href="logistic-regression.html#figure-reffigt3sensspec01">R code</a>)
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:t3sensspec02"></span>
<img src="_main_files/figure-html/t3sensspec02-1.png" alt="Sensitivity/Specificity Plot for Test/Holdout Sample ([R code](#figure-reffigt3sensspec02))" width="672" />
<p class="caption">
Figure 3.19: Sensitivity/Specificity Plot for Test/Holdout Sample (<a href="logistic-regression.html#figure-reffigt3sensspec02">R code</a>)
</p>
</div></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="suggested-readings-2" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Suggested Readings</h2>
<ul>
<li><em>R for Marketing Research and Analytics. 2nd Edition</em> (2019). Chapman, Chris; McDonnel Feit, Elea
<ul>
<li>BGSU Library Link:<br><a href="http://maurice.bgsu.edu/record=b4966554~S9" target="_blank" rel="noopener noreferrer">http://maurice.bgsu.edu/record=b4966554~S9</a></li>
<li>eBook through BGSU Library:<br><a href="https://link-springer-com.ezproxy.bgsu.edu/book/10.1007%2F978-3-030-14316-9" target="_blank" rel="noopener noreferrer">https://link-springer-com.ezproxy.bgsu.edu/book/10.1007%2F978-3-030-14316-9</a></li>
<li>Chapter 9.2: Linear Models for Binary Outcomes: Logistic Regression</li>
</ul></li>
<li><em>OpenIntro Statistics. 4th Edition</em> (2019). Diez, David; Cetinkaya-Rundel, Mine; Barr, Christopher D.
<ul>
<li>Available at OpenIntro.org:<br><a href="https://www.openintro.org/book/os/" target="_blank" rel="noopener noreferrer">https://www.openintro.org/book/os/</a></li>
<li>Chapter 9: Multiple and logistic regression</li>
</ul></li>
<li><em>Multivariate Data Analysis</em>. Hair, Joseph F.; Black, William C.; Babin, Barry J.; Anderson, Rolph E.
<ul>
<li>7th Edition: Search for “multivariate data analysis 7th edition hair”
Chapter 6: Logistic Regression with a Binary Dependent Variable</li>
<li>5th Edition: Course reserves
<ul>
<li>Chapter 5: Multiple Discriminant Analysis and Logistic Regression (pp. 276-281; 314-321)</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="r-code-2" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> R Code</h2>
<div id="figure-reffigt3scatter01" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3scatter01">3.1</a></h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="logistic-regression.html#cb45-1" aria-hidden="true" tabindex="-1"></a>directmktg <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="logistic-regression.html#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">buy01=</span><span class="fu">as.numeric</span>(buy)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>  <span class="co"># Change &#39;buy&#39; to 0-1</span></span>
<span id="cb45-3"><a href="logistic-regression.html#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>buy01)) <span class="sc">+</span></span>
<span id="cb45-4"><a href="logistic-regression.html#cb45-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="logistic-regression.html#cb45-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Age&quot;</span>, <span class="at">y=</span><span class="st">&quot;Buy&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3scatter02" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3scatter02">3.2</a></h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="logistic-regression.html#cb46-1" aria-hidden="true" tabindex="-1"></a>directmktg <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="logistic-regression.html#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(age) <span class="sc">%&gt;%</span>  <span class="co"># Select only the age variable</span></span>
<span id="cb46-3"><a href="logistic-regression.html#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">yhat=</span><span class="fu">predict.lm</span>(model,.)) <span class="sc">%&gt;%</span>  <span class="co"># Predict y from model</span></span>
<span id="cb46-4"><a href="logistic-regression.html#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Next line creates variable to highlight negative predictions</span></span>
<span id="cb46-5"><a href="logistic-regression.html#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">neg=</span><span class="fu">as.factor</span>(<span class="fu">ifelse</span>(yhat<span class="sc">&lt;</span><span class="dv">0</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;No&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb46-6"><a href="logistic-regression.html#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>yhat, <span class="at">color=</span>neg)) <span class="sc">+</span></span>
<span id="cb46-7"><a href="logistic-regression.html#cb46-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb46-8"><a href="logistic-regression.html#cb46-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>,   <span class="co"># Manually set point colors</span></span>
<span id="cb46-9"><a href="logistic-regression.html#cb46-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;No&quot;</span><span class="ot">=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb46-10"><a href="logistic-regression.html#cb46-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">guide=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="logistic-regression.html#cb46-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Age&quot;</span>, <span class="at">y=</span><span class="st">&quot;Linear Prediction&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3lineshape" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3lineshape">3.3</a></h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="logistic-regression.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame grouped by age</span></span>
<span id="cb47-2"><a href="logistic-regression.html#cb47-2" aria-hidden="true" tabindex="-1"></a>dmgrp <span class="ot">&lt;-</span> directmktg <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="logistic-regression.html#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &#39;cut&#39; breaks a continuous variable into groups of each width</span></span>
<span id="cb47-4"><a href="logistic-regression.html#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &#39;as.numeric&#39; keeps the new variable as integer (vs. factor)</span></span>
<span id="cb47-5"><a href="logistic-regression.html#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">agegrp =</span> <span class="fu">as.numeric</span>(<span class="fu">cut</span>(age, <span class="dv">9</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="logistic-regression.html#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(agegrp) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="logistic-regression.html#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">age=</span><span class="fu">mean</span>(age), <span class="at">buy=</span><span class="fu">mean</span>(<span class="fu">as.numeric</span>(buy)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb47-8"><a href="logistic-regression.html#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="logistic-regression.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Run logistic model to create prediction to make s-curve</span></span>
<span id="cb47-10"><a href="logistic-regression.html#cb47-10" aria-hidden="true" tabindex="-1"></a>binmod <span class="ot">&lt;-</span> <span class="fu">glm</span>(buy<span class="sc">~</span>age, directmktg, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb47-11"><a href="logistic-regression.html#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe with predicted values</span></span>
<span id="cb47-12"><a href="logistic-regression.html#cb47-12" aria-hidden="true" tabindex="-1"></a>dmpred <span class="ot">&lt;-</span> directmktg <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="logistic-regression.html#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(age, buy) <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="logistic-regression.html#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">yhat=</span><span class="fu">predict</span>(binmod, <span class="at">type=</span><span class="st">&quot;response&quot;</span>),</span>
<span id="cb47-15"><a href="logistic-regression.html#cb47-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">buy=</span><span class="fu">as.numeric</span>(buy)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb47-16"><a href="logistic-regression.html#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="logistic-regression.html#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create combined plot; each geom with separate data</span></span>
<span id="cb47-18"><a href="logistic-regression.html#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb47-19"><a href="logistic-regression.html#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>directmktg, </span>
<span id="cb47-20"><a href="logistic-regression.html#cb47-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>(<span class="fu">as.numeric</span>(buy)<span class="sc">-</span><span class="dv">1</span>)), </span>
<span id="cb47-21"><a href="logistic-regression.html#cb47-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb47-22"><a href="logistic-regression.html#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data=</span>dmgrp, </span>
<span id="cb47-23"><a href="logistic-regression.html#cb47-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>buy), </span>
<span id="cb47-24"><a href="logistic-regression.html#cb47-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="fl">1.5</span>, <span class="at">color=</span><span class="st">&quot;midnightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-25"><a href="logistic-regression.html#cb47-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data=</span>dmpred, </span>
<span id="cb47-26"><a href="logistic-regression.html#cb47-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>yhat), </span>
<span id="cb47-27"><a href="logistic-regression.html#cb47-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="fl">1.5</span>, <span class="at">color=</span><span class="st">&quot;darkorange&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-28"><a href="logistic-regression.html#cb47-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb47-29"><a href="logistic-regression.html#cb47-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Age&quot;</span>, <span class="at">y=</span><span class="st">&quot;Buy&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3logitcurve" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3logitcurve">3.4</a></h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="logistic-regression.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create simulated data frame based on logistic function</span></span>
<span id="cb48-2"><a href="logistic-regression.html#cb48-2" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">7</span>,<span class="dv">7</span>,.<span class="dv">05</span>)</span>
<span id="cb48-3"><a href="logistic-regression.html#cb48-3" aria-hidden="true" tabindex="-1"></a>fz<span class="ot">=</span><span class="fu">exp</span>(u)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(u))</span>
<span id="cb48-4"><a href="logistic-regression.html#cb48-4" aria-hidden="true" tabindex="-1"></a>ufz<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">u=</span>u, <span class="at">fz=</span>fz)</span>
<span id="cb48-5"><a href="logistic-regression.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot function</span></span>
<span id="cb48-6"><a href="logistic-regression.html#cb48-6" aria-hidden="true" tabindex="-1"></a>ufz <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="logistic-regression.html#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>u, <span class="at">y=</span>fz)) <span class="sc">+</span></span>
<span id="cb48-8"><a href="logistic-regression.html#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;darkorange&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="logistic-regression.html#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>),</span>
<span id="cb48-10"><a href="logistic-regression.html#cb48-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb48-11"><a href="logistic-regression.html#cb48-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="dv">0</span>, <span class="at">minor_breaks=</span><span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb48-12"><a href="logistic-regression.html#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">minor_breaks=</span><span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="logistic-regression.html#cb48-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;u&quot;</span>, <span class="at">y=</span><span class="st">&quot;f(z)&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3roctrain" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3roctrain">3.10</a></h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="logistic-regression.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;logreg_roc.R&#39; user-defined script</span></span>
<span id="cb49-2"><a href="logistic-regression.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It was loaded above with the packages</span></span>
<span id="cb49-3"><a href="logistic-regression.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Requires package &#39;pROC&#39; and &#39;ggplot2</span></span>
<span id="cb49-4"><a href="logistic-regression.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">logreg_roc</span>(model,      <span class="co"># Object with model results</span></span>
<span id="cb49-5"><a href="logistic-regression.html#cb49-5" aria-hidden="true" tabindex="-1"></a>           train)      <span class="co"># Data to use (i.e., training vs. testing)</span></span></code></pre></div>
</div>
<div id="figure-reffigt3roctest" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3roctest">3.11</a></h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="logistic-regression.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;logreg_roc.R&#39; user-defined script</span></span>
<span id="cb50-2"><a href="logistic-regression.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It was loaded above with the packages</span></span>
<span id="cb50-3"><a href="logistic-regression.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Requires package &#39;pROC&#39; and &#39;ggplot2</span></span>
<span id="cb50-4"><a href="logistic-regression.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">logreg_roc</span>(model,      <span class="co"># Object with model results</span></span>
<span id="cb50-5"><a href="logistic-regression.html#cb50-5" aria-hidden="true" tabindex="-1"></a>           test)      <span class="co"># Data to use (i.e., training vs. testing)</span></span></code></pre></div>
</div>
<div id="figure-reffigt3mpage01" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3mpage01">3.12</a></h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="logistic-regression.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Want to predict for different levels of IVs</span></span>
<span id="cb51-2"><a href="logistic-regression.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Because we often do this for other continuous variables, we first</span></span>
<span id="cb51-3"><a href="logistic-regression.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     create a df with mean values of all continuous IVs</span></span>
<span id="cb51-4"><a href="logistic-regression.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     at different levels of the factor variable (if there are any)</span></span>
<span id="cb51-5"><a href="logistic-regression.html#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: variable names must be EXACTLY the same as in model</span></span>
<span id="cb51-6"><a href="logistic-regression.html#cb51-6" aria-hidden="true" tabindex="-1"></a>m.ivs <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="logistic-regression.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="logistic-regression.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">age=</span><span class="fu">mean</span>(age, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb51-9"><a href="logistic-regression.html#cb51-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">salary=</span><span class="fu">mean</span>(salary, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb51-10"><a href="logistic-regression.html#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="logistic-regression.html#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new data for prediction with &#39;age&#39; as focus</span></span>
<span id="cb51-12"><a href="logistic-regression.html#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># This will be used for the next two figures</span></span>
<span id="cb51-13"><a href="logistic-regression.html#cb51-13" aria-hidden="true" tabindex="-1"></a>age.pred <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">data.frame</span>(<span class="at">age=</span><span class="fu">seq</span>(<span class="dv">18</span>,<span class="dv">60</span>,<span class="dv">2</span>)),</span>
<span id="cb51-14"><a href="logistic-regression.html#cb51-14" aria-hidden="true" tabindex="-1"></a>                  m.ivs[ ,<span class="fu">c</span>(<span class="st">&quot;salary&quot;</span>, <span class="st">&quot;gender&quot;</span>)])</span>
<span id="cb51-15"><a href="logistic-regression.html#cb51-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-16"><a href="logistic-regression.html#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with predicted values and confidence bands</span></span>
<span id="cb51-17"><a href="logistic-regression.html#cb51-17" aria-hidden="true" tabindex="-1"></a>train.pred <span class="ot">&lt;-</span> </span>
<span id="cb51-18"><a href="logistic-regression.html#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &#39;cbind&#39; combines objects by columns</span></span>
<span id="cb51-19"><a href="logistic-regression.html#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(age.pred, </span>
<span id="cb51-20"><a href="logistic-regression.html#cb51-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">predict</span>(model, <span class="co"># Model to predict values with</span></span>
<span id="cb51-21"><a href="logistic-regression.html#cb51-21" aria-hidden="true" tabindex="-1"></a>                  age.pred, <span class="co"># New data to use for IVs</span></span>
<span id="cb51-22"><a href="logistic-regression.html#cb51-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type=</span><span class="st">&quot;link&quot;</span>, <span class="co"># Return log-odds predictions</span></span>
<span id="cb51-23"><a href="logistic-regression.html#cb51-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">se=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Get std.err. for CIs</span></span>
<span id="cb51-24"><a href="logistic-regression.html#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">pred=</span><span class="fu">plogis</span>(fit), <span class="co"># Calculate pr(buy)</span></span>
<span id="cb51-25"><a href="logistic-regression.html#cb51-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">upr=</span><span class="fu">plogis</span>(fit<span class="sc">+</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>se.fit)),  <span class="co"># Upper CI</span></span>
<span id="cb51-26"><a href="logistic-regression.html#cb51-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwr=</span><span class="fu">plogis</span>(fit<span class="sc">-</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>se.fit)))  <span class="co"># Lower CI</span></span>
<span id="cb51-27"><a href="logistic-regression.html#cb51-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-28"><a href="logistic-regression.html#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot with gender on same plot</span></span>
<span id="cb51-29"><a href="logistic-regression.html#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>pred), <span class="at">data=</span>train.pred) <span class="sc">+</span></span>
<span id="cb51-30"><a href="logistic-regression.html#cb51-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>gender), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-31"><a href="logistic-regression.html#cb51-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr, <span class="at">ymax=</span>upr, </span>
<span id="cb51-32"><a href="logistic-regression.html#cb51-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color=</span>gender, <span class="at">fill=</span>gender), <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb51-33"><a href="logistic-regression.html#cb51-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb51-34"><a href="logistic-regression.html#cb51-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb51-35"><a href="logistic-regression.html#cb51-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;navy&quot;</span>)) <span class="sc">+</span></span>
<span id="cb51-36"><a href="logistic-regression.html#cb51-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;pink&quot;</span>, <span class="st">&quot;cyan&quot;</span>)) <span class="sc">+</span></span>
<span id="cb51-37"><a href="logistic-regression.html#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Age&quot;</span>, <span class="at">y=</span><span class="st">&quot;Pr(Buy)&quot;</span>, <span class="at">color=</span><span class="st">&quot;Gender&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb51-38"><a href="logistic-regression.html#cb51-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&quot;Calculated at mean value of salary&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3mpage02" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3mpage02">3.13</a></h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="logistic-regression.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot with gender on same plot</span></span>
<span id="cb52-2"><a href="logistic-regression.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>pred), <span class="at">data=</span>train.pred) <span class="sc">+</span></span>
<span id="cb52-3"><a href="logistic-regression.html#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>gender), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="logistic-regression.html#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr, <span class="at">ymax=</span>upr, </span>
<span id="cb52-5"><a href="logistic-regression.html#cb52-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color=</span>gender, <span class="at">fill=</span>gender), <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="logistic-regression.html#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>gender) <span class="sc">+</span></span>
<span id="cb52-7"><a href="logistic-regression.html#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb52-8"><a href="logistic-regression.html#cb52-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb52-9"><a href="logistic-regression.html#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;navy&quot;</span>)) <span class="sc">+</span></span>
<span id="cb52-10"><a href="logistic-regression.html#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;pink&quot;</span>, <span class="st">&quot;cyan&quot;</span>)) <span class="sc">+</span></span>
<span id="cb52-11"><a href="logistic-regression.html#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Age&quot;</span>, <span class="at">y=</span><span class="st">&quot;Pr(Buy)&quot;</span>, <span class="at">caption=</span><span class="st">&quot;Calculated at mean value of salary&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3mpage03" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3mpage03">3.14</a></h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="logistic-regression.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Want to predict for different levels of IVs</span></span>
<span id="cb53-2"><a href="logistic-regression.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Because we often do this for other continuous variables, we first</span></span>
<span id="cb53-3"><a href="logistic-regression.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     create a df with values of all continuous IVs</span></span>
<span id="cb53-4"><a href="logistic-regression.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     at different levels of the factor variable (if there are any)</span></span>
<span id="cb53-5"><a href="logistic-regression.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: variable names must be EXACTLY the same as in model</span></span>
<span id="cb53-6"><a href="logistic-regression.html#cb53-6" aria-hidden="true" tabindex="-1"></a>msd.ivs <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="logistic-regression.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span>  <span class="co"># Group on factor variable</span></span>
<span id="cb53-8"><a href="logistic-regression.html#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate values for different levels of IVs</span></span>
<span id="cb53-9"><a href="logistic-regression.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">age_mn15=</span><span class="fu">mean</span>(age, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">sd</span>(age, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb53-10"><a href="logistic-regression.html#cb53-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_m=</span><span class="fu">mean</span>(age, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb53-11"><a href="logistic-regression.html#cb53-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_mp15=</span><span class="fu">mean</span>(age, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">sd</span>(age, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb53-12"><a href="logistic-regression.html#cb53-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">salary_mn15=</span><span class="fu">mean</span>(salary, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">sd</span>(salary, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb53-13"><a href="logistic-regression.html#cb53-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">salary_m=</span><span class="fu">mean</span>(salary, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb53-14"><a href="logistic-regression.html#cb53-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">salary_mp15=</span><span class="fu">mean</span>(salary, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">sd</span>(salary, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="logistic-regression.html#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert data from wide to long</span></span>
<span id="cb53-16"><a href="logistic-regression.html#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">!</span>gender, <span class="at">names_to=</span><span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>,<span class="st">&quot;measure&quot;</span>), <span class="at">names_sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb53-17"><a href="logistic-regression.html#cb53-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-18"><a href="logistic-regression.html#cb53-18" aria-hidden="true" tabindex="-1"></a>age.pred <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">data.frame</span>(<span class="at">age=</span><span class="fu">seq</span>(<span class="dv">18</span>, <span class="dv">60</span>, <span class="dv">2</span>)), <span class="co"># Variable of interest</span></span>
<span id="cb53-19"><a href="logistic-regression.html#cb53-19" aria-hidden="true" tabindex="-1"></a>                  msd.ivs[,<span class="fu">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;salary&quot;</span>, <span class="st">&quot;measure&quot;</span>)])</span>
<span id="cb53-20"><a href="logistic-regression.html#cb53-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb53-21"><a href="logistic-regression.html#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with predicted values and confidence bands</span></span>
<span id="cb53-22"><a href="logistic-regression.html#cb53-22" aria-hidden="true" tabindex="-1"></a>train.pred <span class="ot">&lt;-</span> </span>
<span id="cb53-23"><a href="logistic-regression.html#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &#39;cbind&#39; combines objects by columns</span></span>
<span id="cb53-24"><a href="logistic-regression.html#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(age.pred, </span>
<span id="cb53-25"><a href="logistic-regression.html#cb53-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">predict</span>(model, <span class="co"># Model to predict values with</span></span>
<span id="cb53-26"><a href="logistic-regression.html#cb53-26" aria-hidden="true" tabindex="-1"></a>                  age.pred, <span class="co"># New data to use for IVs</span></span>
<span id="cb53-27"><a href="logistic-regression.html#cb53-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type=</span><span class="st">&quot;link&quot;</span>, <span class="co"># Return log-odds predictions</span></span>
<span id="cb53-28"><a href="logistic-regression.html#cb53-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">se=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Get std.err. for CIs</span></span>
<span id="cb53-29"><a href="logistic-regression.html#cb53-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pred=</span><span class="fu">plogis</span>(fit), <span class="co"># Calculate pr(buy)</span></span>
<span id="cb53-30"><a href="logistic-regression.html#cb53-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">upr=</span><span class="fu">plogis</span>(fit<span class="sc">+</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>se.fit)),  <span class="co"># Upper CI</span></span>
<span id="cb53-31"><a href="logistic-regression.html#cb53-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">lwr=</span><span class="fu">plogis</span>(fit<span class="sc">-</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>se.fit)),  <span class="co"># Lower CI</span></span>
<span id="cb53-32"><a href="logistic-regression.html#cb53-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">gender=</span><span class="fu">as.factor</span>(gender),  <span class="co"># Factor for plot</span></span>
<span id="cb53-33"><a href="logistic-regression.html#cb53-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">salary=</span><span class="fu">as.factor</span>(measure))  <span class="co"># Factor for plot</span></span>
<span id="cb53-34"><a href="logistic-regression.html#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="logistic-regression.html#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>pred), <span class="at">data=</span>train.pred) <span class="sc">+</span></span>
<span id="cb53-36"><a href="logistic-regression.html#cb53-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>salary), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-37"><a href="logistic-regression.html#cb53-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr, <span class="at">ymax=</span>upr, </span>
<span id="cb53-38"><a href="logistic-regression.html#cb53-38" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color=</span>salary, <span class="at">fill=</span>salary), <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb53-39"><a href="logistic-regression.html#cb53-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>gender) <span class="sc">+</span>  <span class="co"># Create separate plots for gender</span></span>
<span id="cb53-40"><a href="logistic-regression.html#cb53-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-41"><a href="logistic-regression.html#cb53-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="st">&quot;Salary&quot;</span>,</span>
<span id="cb53-42"><a href="logistic-regression.html#cb53-42" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;navy&quot;</span>, <span class="st">&quot;forestgreen&quot;</span>),</span>
<span id="cb53-43"><a href="logistic-regression.html#cb53-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Mean-1.5SD&quot;</span>, <span class="st">&quot;Mean+1.5SD&quot;</span>)) <span class="sc">+</span></span>
<span id="cb53-44"><a href="logistic-regression.html#cb53-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Salary&quot;</span>,</span>
<span id="cb53-45"><a href="logistic-regression.html#cb53-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;pink&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;lawngreen&quot;</span>),</span>
<span id="cb53-46"><a href="logistic-regression.html#cb53-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Mean-1.5SD&quot;</span>, <span class="st">&quot;Mean+1.5SD&quot;</span>)) <span class="sc">+</span></span>
<span id="cb53-47"><a href="logistic-regression.html#cb53-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Age&quot;</span>, <span class="at">y=</span><span class="st">&quot;Pr(Buy)&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3mpage04" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3mpage04">3.15</a></h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="logistic-regression.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use df &#39;msd.ivs&#39; from above</span></span>
<span id="cb54-2"><a href="logistic-regression.html#cb54-2" aria-hidden="true" tabindex="-1"></a>sal.pred <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">data.frame</span>(<span class="at">salary=</span><span class="fu">seq</span>(<span class="dv">15</span>, <span class="dv">150</span>, <span class="dv">5</span>)), <span class="co"># Variable of interest</span></span>
<span id="cb54-3"><a href="logistic-regression.html#cb54-3" aria-hidden="true" tabindex="-1"></a>                  msd.ivs[,<span class="fu">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;measure&quot;</span>)])</span>
<span id="cb54-4"><a href="logistic-regression.html#cb54-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-5"><a href="logistic-regression.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with predicted values and confidence bands</span></span>
<span id="cb54-6"><a href="logistic-regression.html#cb54-6" aria-hidden="true" tabindex="-1"></a>train.pred <span class="ot">&lt;-</span> </span>
<span id="cb54-7"><a href="logistic-regression.html#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &#39;cbind&#39; combines objects by columns</span></span>
<span id="cb54-8"><a href="logistic-regression.html#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(sal.pred, </span>
<span id="cb54-9"><a href="logistic-regression.html#cb54-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">predict</span>(model, <span class="co"># Model to predict values with</span></span>
<span id="cb54-10"><a href="logistic-regression.html#cb54-10" aria-hidden="true" tabindex="-1"></a>                  sal.pred, <span class="co"># New data to use for IVs</span></span>
<span id="cb54-11"><a href="logistic-regression.html#cb54-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type=</span><span class="st">&quot;link&quot;</span>, <span class="co"># Return log-odds predictions</span></span>
<span id="cb54-12"><a href="logistic-regression.html#cb54-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">se=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Get std.err. for CIs</span></span>
<span id="cb54-13"><a href="logistic-regression.html#cb54-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pred=</span><span class="fu">plogis</span>(fit), <span class="co"># Calculate pr(buy)</span></span>
<span id="cb54-14"><a href="logistic-regression.html#cb54-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">upr=</span><span class="fu">plogis</span>(fit<span class="sc">+</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>se.fit)),  <span class="co"># Upper CI</span></span>
<span id="cb54-15"><a href="logistic-regression.html#cb54-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">lwr=</span><span class="fu">plogis</span>(fit<span class="sc">-</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>se.fit)),  <span class="co"># Lower CI</span></span>
<span id="cb54-16"><a href="logistic-regression.html#cb54-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">gender=</span><span class="fu">as.factor</span>(gender),  <span class="co"># Factor for plot</span></span>
<span id="cb54-17"><a href="logistic-regression.html#cb54-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">age=</span><span class="fu">as.factor</span>(measure))  <span class="co"># Factor for plot</span></span>
<span id="cb54-18"><a href="logistic-regression.html#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="logistic-regression.html#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>salary, <span class="at">y=</span>pred), <span class="at">data=</span>train.pred) <span class="sc">+</span></span>
<span id="cb54-20"><a href="logistic-regression.html#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>age), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-21"><a href="logistic-regression.html#cb54-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr, <span class="at">ymax=</span>upr, </span>
<span id="cb54-22"><a href="logistic-regression.html#cb54-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color=</span>age, <span class="at">fill=</span>age), <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb54-23"><a href="logistic-regression.html#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>gender) <span class="sc">+</span>  <span class="co"># Create separate plots for gender</span></span>
<span id="cb54-24"><a href="logistic-regression.html#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-25"><a href="logistic-regression.html#cb54-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="st">&quot;Age&quot;</span>,</span>
<span id="cb54-26"><a href="logistic-regression.html#cb54-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;navy&quot;</span>, <span class="st">&quot;forestgreen&quot;</span>),</span>
<span id="cb54-27"><a href="logistic-regression.html#cb54-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Mean-1.5SD&quot;</span>, <span class="st">&quot;Mean+1.5SD&quot;</span>)) <span class="sc">+</span></span>
<span id="cb54-28"><a href="logistic-regression.html#cb54-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Age&quot;</span>,</span>
<span id="cb54-29"><a href="logistic-regression.html#cb54-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;pink&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;lawngreen&quot;</span>),</span>
<span id="cb54-30"><a href="logistic-regression.html#cb54-30" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Mean-1.5SD&quot;</span>, <span class="st">&quot;Mean+1.5SD&quot;</span>)) <span class="sc">+</span></span>
<span id="cb54-31"><a href="logistic-regression.html#cb54-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Salary&quot;</span>, <span class="at">y=</span><span class="st">&quot;Pr(Buy)&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3gainplot" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3gainplot">3.16</a></h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="logistic-regression.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot was already returned in the previous call to &#39;gainlift&#39;</span></span>
<span id="cb55-2"><a href="logistic-regression.html#cb55-2" aria-hidden="true" tabindex="-1"></a>glresults<span class="sc">$</span>gainplot</span></code></pre></div>
</div>
<div id="figure-reffigt3liftplot" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3liftplot">3.17</a></h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="logistic-regression.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot was already returned in the previous call to &#39;gainlift&#39;</span></span>
<span id="cb56-2"><a href="logistic-regression.html#cb56-2" aria-hidden="true" tabindex="-1"></a>glresults<span class="sc">$</span>gainlift</span></code></pre></div>
</div>
<div id="figure-reffigt3sensspec01" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3sensspec01">3.18</a></h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="logistic-regression.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;logreg_cut.R&#39; user-defined script</span></span>
<span id="cb57-2"><a href="logistic-regression.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It was loaded above with the packages</span></span>
<span id="cb57-3"><a href="logistic-regression.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Requires packages &#39;ggplot2&#39;</span></span>
<span id="cb57-4"><a href="logistic-regression.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">logreg_cut</span>(model, train, <span class="st">&quot;Yes&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-reffigt3sensspec02" class="section level3 unlisted unnumbered">
<h3>Figure <a href="logistic-regression.html#fig:t3sensspec02">3.19</a></h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="logistic-regression.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;logreg_cut.R&#39; user-defined script</span></span>
<span id="cb58-2"><a href="logistic-regression.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It was loaded above with the packages</span></span>
<span id="cb58-3"><a href="logistic-regression.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Requires packages &#39;ggplot2&#39;</span></span>
<span id="cb58-4"><a href="logistic-regression.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">logreg_cut</span>(model, test, <span class="st">&quot;Yes&quot;</span>)</span></code></pre></div>
</div>
<div id="table-reftabt3linreg01" class="section level3 unlisted unnumbered">
<h3>Table <a href="logistic-regression.html#tab:t3linreg01">3.1</a></h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="logistic-regression.html#cb59-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> directmktg <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="logistic-regression.html#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">buy=</span><span class="fu">as.numeric</span>(buy)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="logistic-regression.html#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(buy <span class="sc">~</span> age, .)</span>
<span id="cb59-4"><a href="logistic-regression.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: &#39;summ&#39; uses the &#39;jtools&#39; package</span></span>
<span id="cb59-5"><a href="logistic-regression.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(model, <span class="at">model.info=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">4</span>)</span>
<span id="cb59-6"><a href="logistic-regression.html#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For virtual environment, use &#39;summary&#39; from Base R,</span></span>
<span id="cb59-7"><a href="logistic-regression.html#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># but manually calculate McFadden&#39;s Pseudo-Rsq</span></span>
<span id="cb59-8"><a href="logistic-regression.html#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb59-9"><a href="logistic-regression.html#cb59-9" aria-hidden="true" tabindex="-1"></a>Mrsq <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>model<span class="sc">$</span>deviance<span class="sc">/</span>model<span class="sc">$</span>null.deviance</span>
<span id="cb59-10"><a href="logistic-regression.html#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;McFadden&#39;s Pseudo-Rsquared = &quot;</span>, <span class="fu">round</span>(Mrsq, <span class="at">digits=</span><span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="table-reftabt3logit01" class="section level3 unlisted unnumbered">
<h3>Table <a href="logistic-regression.html#tab:t3logit01">3.2</a></h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="logistic-regression.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use &#39;caret&#39; package to create training and test/holdout samples</span></span>
<span id="cb60-2"><a href="logistic-regression.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This will create two separate dataframes: train and test</span></span>
<span id="cb60-3"><a href="logistic-regression.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4320</span>)</span>
<span id="cb60-4"><a href="logistic-regression.html#cb60-4" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y=</span>directmktg<span class="sc">$</span>buy, <span class="at">p=</span>.<span class="dv">75</span>, <span class="at">list=</span><span class="cn">FALSE</span>)</span>
<span id="cb60-5"><a href="logistic-regression.html#cb60-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> directmktg[inTrain,]</span>
<span id="cb60-6"><a href="logistic-regression.html#cb60-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> directmktg[<span class="sc">-</span>inTrain,]</span>
<span id="cb60-7"><a href="logistic-regression.html#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="logistic-regression.html#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the model on the training data</span></span>
<span id="cb60-9"><a href="logistic-regression.html#cb60-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(buy <span class="sc">~</span> age <span class="sc">+</span> salary <span class="sc">+</span> gender, train, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb60-10"><a href="logistic-regression.html#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: &#39;summ&#39; uses the &#39;jtools&#39; package</span></span>
<span id="cb60-11"><a href="logistic-regression.html#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(model, <span class="at">model.info=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">4</span>)</span>
<span id="cb60-12"><a href="logistic-regression.html#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co"># For virtual environment, use &#39;summary&#39; from Base R</span></span></code></pre></div>
</div>
<div id="table-reftabt3logit01or" class="section level3 unlisted unnumbered">
<h3>Table <a href="logistic-regression.html#tab:t3logit01or">3.3</a></h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="logistic-regression.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;or_table.R&#39; user-defined script</span></span>
<span id="cb61-2"><a href="logistic-regression.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It was loaded above with the packages</span></span>
<span id="cb61-3"><a href="logistic-regression.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(<span class="fu">or_table</span>(model))</span></code></pre></div>
</div>
<div id="table-reftabt3cmtrain" class="section level3 unlisted unnumbered">
<h3>Table <a href="logistic-regression.html#tab:t3cmtrain">3.4</a></h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="logistic-regression.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;logreg_cm.R&#39; user-defined script</span></span>
<span id="cb62-2"><a href="logistic-regression.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It was loaded above with the packages</span></span>
<span id="cb62-3"><a href="logistic-regression.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Requires package &#39;caret&#39;</span></span>
<span id="cb62-4"><a href="logistic-regression.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">logreg_cm</span>(model,      <span class="co"># Object with model results</span></span>
<span id="cb62-5"><a href="logistic-regression.html#cb62-5" aria-hidden="true" tabindex="-1"></a>          train,      <span class="co"># Data to use (i.e., training vs. testing)</span></span>
<span id="cb62-6"><a href="logistic-regression.html#cb62-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Yes&quot;</span>)      <span class="co"># Factor level for &quot;True&quot;</span></span></code></pre></div>
</div>
<div id="table-reftabt3cmtest" class="section level3 unlisted unnumbered">
<h3>Table <a href="logistic-regression.html#tab:t3cmtest">3.5</a></h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="logistic-regression.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;logreg_cm.R&#39; user-defined script</span></span>
<span id="cb63-2"><a href="logistic-regression.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It was loaded above with the packages</span></span>
<span id="cb63-3"><a href="logistic-regression.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Requires package &#39;caret&#39;</span></span>
<span id="cb63-4"><a href="logistic-regression.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">logreg_cm</span>(model,      <span class="co"># Object with model results</span></span>
<span id="cb63-5"><a href="logistic-regression.html#cb63-5" aria-hidden="true" tabindex="-1"></a>          test,      <span class="co"># Data to use (i.e., training vs. testing)</span></span>
<span id="cb63-6"><a href="logistic-regression.html#cb63-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Yes&quot;</span>)      <span class="co"># Factor level for &quot;True&quot;</span></span></code></pre></div>
</div>
<div id="table-reftabt3gaintable" class="section level3 unlisted unnumbered">
<h3>Table <a href="logistic-regression.html#tab:t3gaintable">3.6</a></h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="logistic-regression.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;gainlift.R&#39; user-defined script</span></span>
<span id="cb64-2"><a href="logistic-regression.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It was loaded above with the packages</span></span>
<span id="cb64-3"><a href="logistic-regression.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Requires packages &#39;ggplot2&#39;, &#39;dplyr&#39;, and &#39;tidyr&#39;</span></span>
<span id="cb64-4"><a href="logistic-regression.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns a list of four things:</span></span>
<span id="cb64-5"><a href="logistic-regression.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   gainplot, liftplot, gaintable, lifttable</span></span>
<span id="cb64-6"><a href="logistic-regression.html#cb64-6" aria-hidden="true" tabindex="-1"></a>glresults <span class="ot">&lt;-</span> <span class="fu">gainlift</span>(model, train, test, <span class="st">&quot;Yes&quot;</span>)</span>
<span id="cb64-7"><a href="logistic-regression.html#cb64-7" aria-hidden="true" tabindex="-1"></a>glresults<span class="sc">$</span>gaintable</span></code></pre></div>
</div>
<div id="table-reftabt3lifttable" class="section level3 unlisted unnumbered">
<h3>Table <a href="logistic-regression.html#tab:t3lifttable">3.7</a></h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="logistic-regression.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table was already returned in the previous call to &#39;gainlift&#39;</span></span>
<span id="cb65-2"><a href="logistic-regression.html#cb65-2" aria-hidden="true" tabindex="-1"></a>glresults<span class="sc">$</span>lifttable</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="targeting-and-retaining-customers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"number_sections": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
